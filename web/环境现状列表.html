<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>环境现状列表</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-table.css">

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-table.js"></script>
    <script src="js/bootstrap-table-zh-CN.js"></script>

    <style>
        /*.modal-body div input {*/
        /*color: #5cb85c;*/
        /*}*/
    </style>
</head>
<body>
<!--新增按钮对应的模态框-->
<div class="modal fade" tabindex="-1" role="dialog" id="addModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">新增现状环境整治措施内容</h4>
            </div>
            <div class="modal-body">
                <div style="padding: 0% 5%">
                    <input id="addId" type="text" class="form-control" placeholder="现状环境整治编号"><br/>
                    <input id="addName" type="text" class="form-control" placeholder="名字"><br/>
                    <input id="addDepartment" type="text" class="form-control" placeholder="所属文物保护单位"><br/>
                    <input id="addDescription" type="text" class="form-control" placeholder="整治说明"><br/>
                    <input id="addDate" type="text" class="form-control" placeholder="时代"><br/>
                    <input id="addAddress" type="text" class="form-control" placeholder="所在地址"><br/>
                    <input id="addComments" type="text" class="form-control" placeholder="备注">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-default" id="addClear">清空</button>
                <button type="button" class="btn btn-primary" id="add">新增</button>
            </div>
        </div>
    </div>
</div>

<!--修改按钮对应的模态框-->
<div class="modal fade" tabindex="-1" role="dialog" id="modifyModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">修改现状环境整治措施内容</h4>
            </div>
            <div class="modal-body">
                <div style="padding: 0% 5%">
                    <input id="editId" type="text" class="form-control" placeholder="现状环境整治编号"><br/>
                    <input id="editName" type="text" class="form-control" placeholder="名字"><br/>
                    <input id="editDepartment" type="text" class="form-control" placeholder="所属文物保护单位"><br/>
                    <input id="editDescription" type="text" class="form-control" placeholder="整治说明"><br/>
                    <input id="editDate" type="text" class="form-control" placeholder="时代"><br/>
                    <input id="editAddress" type="text" class="form-control" placeholder="所在地址"><br/>
                    <input id="editComments" type="text" class="form-control" placeholder="备注">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-default" id="editClear">清空</button>
                <button type="button" class="btn btn-success" id="edit">修改</button>
            </div>
        </div>
    </div>
</div>

<!--查看按钮对应的模态框-->
<div class="modal fade" tabindex="-1" role="dialog" id="detailModal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">查看现状环境整治措施内容细节</h4>
            </div>
            <div class="modal-body">
                <div style="padding: 0% 5%">
                    <input type="text" class="form-control" placeholder="现状环境整治编号" id="detailId"><br/>
                    <input type="text" class="form-control" placeholder="名字" id="detailName"><br/>
                    <input type="text" class="form-control" placeholder="所属文物保护单位" id="detailDepartment"><br/>
                    <input type="text" class="form-control" placeholder="整治说明" id="detailDescription"><br/>
                    <input type="text" class="form-control" placeholder="时代" id="detailDate"><br/>
                    <input type="text" class="form-control" placeholder="所在地址" id="detailAddress"><br/>
                    <input type="text" class="form-control" placeholder="备注" id="detailComments">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="row">
        <div class="col-lg-7" style="margin:2% 0% 1% 0%">
            <div class="input-group">
                <span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span>
                <input type="text" class="form-control" placeholder="现状环境整治措施" id="searchContent">
            </div>
        </div>
        <div class="col-lg-5 text-right" style="margin:2% 0% 1% 0%">
            <div class="btn-group">
                <button id="btn_search" type="button" class="btn btn-default" style="width: 100px">搜索</button>
                <button id="btn_clear" type="button" class="btn btn-default" style="width: 100px">清空</button>
            </div>
        </div>
    </div>

    <div id="toolbar" class="btn-group">
        <button id="btn_add" type="button" class="btn btn-success">
            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>&nbsp;新增
        </button>
        <button id="btn_edit" type="button" class="btn btn-default">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>&nbsp;修改
        </button>
        <button id="btn_delete" type="button" class="btn btn-danger">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>&nbsp;删除
        </button>
        <button id="btn_display" type="button" class="btn btn-info">
            <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>&nbsp;查看
        </button>
    </div>
    <table id="table"></table>
</div>

<script>
    createBootstrapTable('#table', '#toolbar');

    $("#btn_add").bind("click", function (e) {
        $("#addModal").modal();
    })

    $("#btn_edit").bind("click", function (e) {
        var selectItems = $("#table").bootstrapTable('getSelections');
        if (selectItems.length == 0)
            return;
        $("#editId").val(selectItems[0].id);
        $("#editName").val(selectItems[0].name);
        $("#editDepartment").val(selectItems[0].department);
        $("#editDescription").val(selectItems[0].description);
        $.ajax({
            type: 'get',
            url: "http://localhost:8080/web/getDetailById?id=" + selectItems[0].id,
            success: function (data) {
                var temp = eval('('+data+')');
                $("#editAddress").val(temp.address);
                $("#editDate").val(temp.date);
                $("#editComments").val(temp.comments);
                $("#modifyModal").modal();
            },
            error: function () {
                alert("添加细节出错");
            }
        })
    })

    $("#btn_delete").bind("click", function (e) {
        var a = $("#table").bootstrapTable('getSelections');
        if (selectItems.length == 0)
            return;
        alert(a[0].description);
    })

    $("#btn_display").bind("click", function (e) {
        var selectItems = $("#table").bootstrapTable('getSelections');
        if (selectItems.length == 0)
            return;
        $("#detailId").val(selectItems[0].id);
        $("#detailName").val(selectItems[0].name);
        $("#detailDepartment").val(selectItems[0].department);
        $("#detailDescription").val(selectItems[0].description);
        $.ajax({
            type: 'get',
            url: "http://localhost:8080/web/getDetailById?id=" + selectItems[0].id,
            success: function (data) {
                var temp = eval('('+data+")");
                $("#detailAddress").val(temp.address);
                $("#detailDate").val(temp.date);
                $("#detailComments").val(temp.comments);
                $("#detailModal").modal();
            },
            error: function () {
                alert("添加细节出错");
            }
        })

    })

    $("#btn_search").bind("click", function (e) {
        addData($("#searchContent").val());
    })

    $("#btn_clear").bind("click", function (e) {
        $("#searchContent").val("");
    })

    $("#addClear").bind("click", function (e) {
        $("#addId").val("");
        $("#addName").val("");
        $("#addDepartment").val("");
        $("#addDescription").val("");
        $("#addAddress").val("");
        $("#addComments").val("");
        $("#addDate").val("");
    })
    $("#add").bind("click", function (e) {
        var data = {
            id: $("#addId").val(),
            name: $("#addName").val(),
            department: $("#addDepartment").val(),
            description: $("#addDescription").val(),
            address: $("#addAddress").val(),
            comments: $("#addComments").val(),
            date: $("#addDate").val()
        };
        $.ajax({
            type: 'post',
            data: data,
            url: "http://localhost:8080/web/getlist?searchContent=" + searchContent,
            success: function (data) {
                $("#table").bootstrapTable("load", eval(data));
            },
            error: function () {
                alert("err");
            }
        })
    })
    $("#editClear").bind("click", function (e) {
        $("#editId").val("");
        $("#editName").val("");
        $("#editDepartment").val("");
        $("#editDescription").val("");
        $("#editAddress").val("");
        $("#editComments").val("");
        $("#editDate").val("");
    })
    $("#edit").bind("click", function (e) {
        var data = {
            id: $("#editId").val(),
            name: $("#editName").val(),
            department: $("#editDepartment").val(),
            description: $("#editDescription").val(),
            address: $("#editAddress").val(),
            comments: $("#editComments").val(),
            date: $("#editDate").val()
        };
        $.ajax({
            type: 'post',
            data: data,
            url: "http://localhost:8080/web/getlist?searchContent=" + searchContent,
            success: function (data) {
                $("#table").bootstrapTable("load", eval(data));
            },
            error: function () {
                alert("err");
            }
        })
    })


    $(".search input").attr('placeholder', "列表内搜索")


    function createBootstrapTable(table, toolbar) {
        init(table, toolbar);
    }

    function init(table, toolbar) {
        $(table).bootstrapTable({
            toolbar: toolbar,                   //工具按钮用哪个容器
            striped: true,                      //是否显示行间隔色
            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
            pagination: true,                   //是否显示分页（*）
            sortable: false,                    //是否启用排序
            sortOrder: "asc",                   //排序方式
            sidePagination: "client",           //分页方式：client客户端分页，server服务端分页（*）
            pageNumber: 1,                       //初始化加载第一页，默认第一页
            pageSize: 8,                       //每页的记录行数（*）
            pageList: [8, 10, 20, 50],            //可供选择的每页的行数（*）
            search: true,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
            strictSearch: false,                 //严格搜索
            showColumns: true,                  //是否显示所有的列
            showRefresh: true,                  //是否显示刷新按钮
            minimumCountColumns: 2,             //最少允许的列数
            clickToSelect: true,                //是否启用点击选中行
            height: 500,                         //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
            uniqueId: "id",                     //每一行的唯一标识，一般为主键列

            showToggle: false,                    //是否显示详细视图和列表视图的切换按钮
            cardView: false,                    //是否显示详细视图
            detailView: false,                  //是否显示父子表
            columns: [
                {
                    width: "5%",
                    checkbox: true,
                },
                {
                    field: "id",
                    title: "现状环境整治编号",
                    width: "20%",
                    sortable: true,
                },
                {
                    field: "name",
                    title: "名字",
                    width: "20%",
                },
                {
                    field: "department",
                    title: "所属文物保护单位",
                    width: "20%",
                },
                {
                    field: "description",
                    title: "整治说明",
                    width: "35%",
                }
            ],
            //传递参数（*），这里应该返回一个object，即形如{param1:val1,param2:val2}
            /* sidePagination:server模式下的时候 需要添加的选项
             url: url,                           //请求后台的URL（*）
             method: 'post',                     //请求方式（*）
             dataType: "json",                   //json格式数据
             queryParams: function queryParams(params) {
             var param = {
             pageNumber: params.pageNumber,
             pageSize: params.pageSize,
             orderNum: $("#orderNum").val()
             };
             return param;
             },
             onLoadSuccess: function () {  //加载成功时执行
             layer.msg("加载成功");
             },
             onLoadError: function () {  //加载失败时执行
             layer.msg("加载数据失败", {time: 1500, icon: 2});
             }

             */
        });
    }

    function addData(searchContent) {
        $.ajax({
            type: 'get',
            url: "http://localhost:8080/web/getlist?searchContent=" + searchContent,
            success: function (data) {
                $("#table").bootstrapTable("load", eval(data));
            },
            error: function () {
                //请求出错处理
                alert("err");
            }
        })
    }

</script>
</body>
</html>